\documentclass[11pt]{article}

\input{preamble.tex}

\title{%
    A report \\
    \large WI4204 - Advanced Modelling
}
\author{Philip Soliman (4945255), Auke Schaap (4457919)}
\date{April 2023}

\begin{document}
\maketitle


\section{Probleemanalyse}
Als we uit de situatie het probleem afleiden \textbf{<VOEG AFLEIDNG IN>}, dan komen we uit op het volgende verband:

\begin{equation}
    f(x,y)+\text{div}\left[\frac{1}{\mu} \;\text{grad}\;u\right] = \sigma \frac{\partial u}{\partial t},
\end{equation}
met de variablen:
\begin{itemize}
    \item $u$ is $A$.
    \item $f(x,y)$: de current density in de z-richting ($J_z$) 
    \item $\mu$: de permeabiliteit van het materiaal
    \item $\sigma$: de conductiviteit van het materiaal.
\end{itemize}

Om dit probleem direct op te lossen (met FEM), leiden we de volgende weak form af:
\begin{equation*}
    \sigma M \dot u = \frac{1}{\mu}A u + f,
\end{equation*}
waar M diagonaal is. Omdat er heel veel tijdsstappen zijn gaat dat echter heel lang duren. Er zijn een aantal manieren om dit probleem te versimpelen.

\subsection{Single frequency}
Eén mogelijke aanname is dat, omdat de stroom een constante frequentie heeft, $u$ ook één frequentie heeft. Dan is seperation of variables geldig, en kunnen we seperation of variables toepassen:
\begin{align*}
    u(x,y,t) = \hat u(x,y) \cdot e^{j\omega t}.
\end{align*}
Dit proces betekent dus dat $\frac{\partial}{\partial t} \to \omega j$. Ons nieuwe systeem is dan:
\begin{equation*}
    \hat f(x,y)+\text{div}\left[\frac{1}{\mu} \;\text{grad}\;\hat u\right] = j\sigma \omega \hat u,
\end{equation*}
met de weak form
\begin{equation*}
    \left[j\sigma \omega M + \frac{1}{\mathbf \mu}A\right]\hat u = \hat f.
\end{equation*}

\subsection{Meerdere frequenties}
De aanname dat er één frequentie is, is niet geldig. STEDIN meet namelijk dat dit niet het geval is. We kunnen het probleem ook opsplitsen in meerdere frequenties:
\begin{equation}
    u(x,y,t) = \hat u_1(x,y) e^{j\omega_1 t} + \hat u_2(x,y) e^{j\omega_2 t} + \dots.
\end{equation}

\subsubsection{Superpositie}
Als we aannemen de frequenties elkaar niet beïnvloeden, kunnen we $\hat u_1(x,y)$ en $\hat u_2(x,y)$ apart oplossen.

\subsubsection{Gekoppeld}
De aanname dat de frequenties elkaar niet kunnen beïnvloeden is echter niet juist. De permeabiliteit $\mu$ hangt namelijk af van $\text{grad} \; u$. In werkelijkheid is dit systeem dus gekoppeld. Hoe reken je tegelijkertijd meerdere frequenties door? Dit roept de vraag op of het dan toch niet beter is om het probleem direct op te lossen.


\section{Naar het systeem}

We hebben de volgende weak form afgeleidt:
\begin{equation}
    \sigma M \dot u = \frac{1}{\mu}A u + f.
\end{equation}
Dit willen we transformeren in een systeem van vergelijkingen. De stiffness matrix $A$.

\begin{align*}
    \int_{\Omega_e} \nabla \times \left(\frac{1}{\mu} \nabla \times \hat u\right) d \Omega \\
    \omega = \sum_i c_i B_i\\
    \hat u = \sum_j c_j \hat B_j
\end{align*}

Kunnen we het ook zonder numerieke integratie doen (dus analytisch)? En anders, welke ... integratie rule gebruiken we? (Gauss-Legendre)

Antwoord Philip: Je hebt een library sympy om dat te doen. Dat rekent de basis functions analytisch uit.

\subsection{De matrix M}

Voor het element $e_k$:
\begin{align*}
    M_{e_k} = \left[\int_{\Omega_{e_k}}\phi_i\phi_jdxdy\right]_{1 \leq i, j \leq 3}
\end{align*}

We gaan deze matrix diagnoaal maken. Door een approximatie (kwadratuur?)
\begin{align*}
    \int_{\Omega_e}g(x,y)dxdy \approx (\text{area}) \cdot (\text{gemiddelde waarde}) \\
    \left[\phi_i\phi_j\right]_{i \leq i,j \leq 3} = I_{3 \times 3}
\end{align*}

Voor de $f$ doen we hetzelfde.

\end{document}